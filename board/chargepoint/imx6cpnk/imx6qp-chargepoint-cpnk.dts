/*
 * Copyright 2020 ChargePoint, Inc.
 * Copyright 2013 Boundary Devices
 * Copyright 2012 Freescale Semiconductor, Inc.
 * Copyright 2011 Linaro Ltd.
 *
 * The code contained herein is licensed under the GNU General Public
 * License. You may obtain a copy of the GNU General Public License
 * Version 2 or later at the following locations:
 *
 * http://www.opensource.org/licenses/gpl-license.html
 * http://www.gnu.org/copyleft/gpl.html
 */
/*
 * XXX - THIS NEEDS TO BE AUDITED - XXX
 *
 * At the time of this comment, this device-tree was changed to just
 * make a boot happen
 */


/dts-v1/;

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>
#include "imx6q.dtsi"
#include "imx6qp.dtsi"

#if defined(CONFIG_NOT_UUU_BUILD)
#include "chargepoint-pubkey.dtsi"
#endif

/ {
	model = "ChargePoint i.MX6QP CPNK Board";
	compatible = "fsl,imx6qp-chargepoint-cpnk", "fsl,imx6q";

	aliases {
		fb_hdmi = &fb_hdmi;
		fb_lvds = &fb_lvds;
		ldb = &ldb;
		mmc0 = &usdhc3;
		mxcfb0 = &fb_lvds;
		mxcfb1 = &fb_hdmi;
	};

	chosen {
		stdout-path = &uart1;
	};

	memory: memory {
		reg = <0x10000000 0x40000000>;
	};

	backlight_lvds0 {
		compatible = "pwm-backlight";
		pinctrl-names = "default";
		brightness-levels = <0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \
			      31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 \
			      61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 80 \
			      91 92 93 94 95 96 97 98 99 100>;
		default-brightness-level = <100>;
		display = <&fb_lvds>;
		pwms = <&pwm1 0 5000000>;
		status = "okay";
	};

	clocks {
		clk24m: clk24m {
			compatible = "fixed-clock";
			#clock-cells = <0>;
			clock-frequency = <24000000>;
		};
	};

	sound {
		compatible = "fsl,imx6q-sabresd-wm8974",
		"fsl,imx-audio-wm8974";
		model = "wm8974-audio";
		cpu-dai = <&ssi1>;
		audio-codec = <&codec>;
		audio-routing =
			  "Ext Spk", "MONOOUT",
			  "Mic Jack", "Mic Bias",
			  "Headphone Jack", "MONOOUT";
		mux-int-port = <1>;
		mux-ext-port = <4>;
		status = "okay";
	};

	sound-hdmi {
		compatible = "fsl,imx6q-audio-hdmi",
			     "fsl,imx-audio-hdmi";
		model = "imx-audio-hdmi";
		hdmi-controller = <&hdmi_audio>;
	};

	fb_lvds: fb@0 {
		compatible = "fsl,mxc_sdc_fb";
		disp_dev = "ldb";
		interface_pix_fmt = "RGB24";
		default_bpp = <32>;
		int_clk = <0>;
		late_init = <0>;
		status = "disabled";
	};

	fb_hdmi: fb@1 {
		compatible = "fsl,mxc_sdc_fb";
		disp_dev = "hdmi";
		interface_pix_fmt = "RGB24";
		mode_str ="1920x1080M@60";
		default_bpp = <32>;
		int_clk = <0>;
		late_init = <0>;
		status = "disabled";
	};

	regulators {
		compatible = "simple-bus";
		#address-cells = <1>;
		#size-cells = <0>;

		reg_sys_p24v: regulator-system-p24v {
			compatible = "regulator-fixed";
			regulator-name = "P24V";
			regulator-min-microvolt = <24000000>;
			regulator-max-microvolt = <24000000>;
			regulator-always-on;
		};

		reg_p5v0: regulator-p5v0 {
			compatible = "regulator-fixed";
			regulator-name = "P5V0";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			regulator-always-on;
		};

		reg_p3v3: regulator-p3v3 {
			compatible = "regulator-fixed";
			regulator-name = "P3V3";
			regulator-min-microvolt = <3300000>;
			regulator-max-microvolt = <3300000>;
			regulator-always-on;
		};

		reg_usbotg_vbus: regulator-usbotg-vbus {
			compatible = "regulator-fixed";
			regulator-name = "usb_otg_vbus";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			gpio = <&gpio3 22 GPIO_ACTIVE_HIGH>;
			enable-active-high;
			regulator-always-on;
			vin-supply = <&reg_p5v0>;
		};

		reg_usbh1_vbus: regulator-usbh1-vbus {
			compatible = "regulator-fixed";
			pinctrl-names = "default";
			pinctrl-0 = <&pinctrl_reg_usbh1_vbus>;
			regulator-name = "usb_h1_vbus";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			gpio = <&gpio1 4 GPIO_ACTIVE_HIGH>;
			enable-active-high;
			regulator-always-on;
			vin-supply = <&reg_p5v0>;
		};

		reg_mipi_avdd: regulator-mipi-avdd {
			 compatible = "regulator-fixed";
			 regulator-name = "mipi_avdd";
			 regulator-min-microvolt = <2800000>;
			 regulator-max-microvolt = <2800000>;
			 regulator-always-on;
		};

		reg_mipi_dovdd: regulator-mipi-dovdd {
			 compatible = "regulator-fixed";
			 regulator-name = "mipi_dovdd";
			 regulator-min-microvolt = <1800000>;
			 regulator-max-microvolt = <1800000>;
			 regulator-always-on;
		};

		reg_mipi_dvdd: regulator-mipi-dvdd {
			 compatible = "regulator-fixed";
			 regulator-name = "mipi_dvdd";
			 regulator-min-microvolt = <1500000>;
			 regulator-max-microvolt = <1500000>;
			 regulator-always-on;
		};

		reg_audio: regulator-audio {
			compatible = "regulator-fixed";
			regulator-name = "wm8974-supply";
			regulator-always-on;
		};
		reg_spk_audio: regulator-speaker-audio {
			compatible = "regulator-fixed";
			regulator-name = "wm8974-spk-supply";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			/*gpio = <&gpio4 25 0>;*/
			enable-active-high;
			regulator-always-on;
		};
	};

	v4l2_cap_0 {
		compatible = "fsl,imx6q-v4l2-capture";
		ipu_id = <0>;
		csi_id = <0>;
		mclk_source = <0>;
		status = "okay";
	};

	v4l2_cap_1: v4l2_cap_1 {
		compatible = "fsl,imx6q-v4l2-capture";
		ipu_id = <0>;
		csi_id = <1>;
		mipi_camera = <1>;
		mclk_source = <0>;
		status = "okay";
	};

	v4l2_cap_2: v4l2_cap_2 {
		compatible = "fsl,imx6q-v4l2-capture";
		ipu_id = <1>;
		csi_id = <0>;
		mipi_camera = <1>;
		mclk_source = <0>;
		status = "okay";
	};

	v4l2_out {
		compatible = "fsl,mxc_v4l2_output";
		status = "okay";
	};

	reserved-memory {
		linux,cma {
			size = <0x1A000000>;
		};
	};
};

&fb_hdmi {
	prefetch;
	status = "okay";
};

&fb_lvds {
	prefetch;
	status = "okay";
};

&pre1 {
	status = "okay";
};

&pre2 {
	status = "okay";
};

&pre3 {
	status = "okay";
};

&pre4 {
	status = "okay";
};

&prg1 {
	memory-region = <&memory>;
	status = "okay";
};

&prg2 {
	memory-region = <&memory>;
	status = "okay";
};

&iomuxc {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_hog>;
	iomuxc_imx6q_cpnk: iomuxc-imx6q-cpnk-grp {
		status = "okay";
	};
};

&iomuxc_imx6q_cpnk {
	pinctrl_hog: hoggrp {
		fsl,pins = <
		  MX6QDL_PAD_SD2_DAT2__GPIO1_IO13 0x1b0b0 /* LG CHG_ENABLE */
		  /*MX6QDL_PAD_KEY_COL0__GPIO4_IO06 0x1b0b0*/ /* NFC_IRQ(RFID) */
		  /*MX6QDL_PAD_KEY_ROW0__GPIO4_IO07 0x130b0*/ /* RFID Reset, pull-down */
		  MX6QDL_PAD_KEY_COL4__GPIO4_IO14 0x130b0 /* UX 5V enable, pull-down */
		  MX6QDL_PAD_KEY_ROW2__GPIO4_IO11 0x130b0 /* UX_GPIO2, pull-down */
		  MX6QDL_PAD_KEY_COL2__GPIO4_IO10 0x130b0 /* GestIC reset, pull-down */
		  MX6QDL_PAD_EIM_D23__GPIO3_IO23 0x1b0b0 /* MOD_PWREN */
		  MX6QDL_PAD_EIM_D24__GPIO3_IO24 0x1b0b0 /* MOD_RESETn */
		  MX6QDL_PAD_GPIO_18__GPIO7_IO13 0x1b0b0 /* MOD_IGTn */
		  MX6QDL_PAD_GPIO_19__GPIO4_IO05 0x1b0b0 /* MOD_PWRIND */
		  MX6QDL_PAD_DISP0_DAT4__GPIO4_IO25 0x1b0b0 /* SPK_PWREN */
		  MX6QDL_PAD_NANDF_D0__GPIO2_IO00 0x1b0b0 /* DBG LED90 */
		  MX6QDL_PAD_NANDF_D1__GPIO2_IO01 0x1b0b0 /* DBG LED91 */
		  MX6QDL_PAD_NANDF_D2__GPIO2_IO02 0x1b0b0 /* DBG LED92 */
		  MX6QDL_PAD_NANDF_D3__GPIO2_IO03 0x1b0b0 /* DBG LED93 */
		  MX6QDL_PAD_EIM_D19__GPIO3_IO19 0x1b0b0 /* WIFI_PWREN */
		  MX6QDL_PAD_EIM_D20__GPIO3_IO20 0x1b0b0 /* WIFI RESET */
		  /*MX6QDL_PAD_CSI0_DAT6__GPIO5_IO24 0x1b0b0*/ /* CAM_RESET_n */
		  /*MX6QDL_PAD_CSI0_DAT7__GPIO5_IO25 0x1b0b0*/ /* CAM_PWDN_n */
		  MX6QDL_PAD_DISP0_DAT0__GPIO4_IO21 0x1b0b0  /* LCD PWREN */
		  MX6QDL_PAD_DISP0_DAT1__GPIO4_IO22 0x1b0b0  /* LCD_REV_SCAN */
		  MX6QDL_PAD_DISP0_DAT2__GPIO4_IO23 0x1b0b0  /* LCD_SEL_6o8 */
		  MX6QDL_PAD_DISP0_DAT9__GPIO4_IO30 0x1b0b0  /* LVSS_3V_PWREN */
		  MX6QDL_PAD_DISP0_DAT3__GPIO4_IO24 0x1b0b0 /* Ultrasonic sensor PWREN */
		  MX6QDL_PAD_DISP0_DAT18__GPIO5_IO12 0x1b0b0 /* I2C PMIC ENABLE */
		  MX6QDL_PAD_GPIO_6__GPIO1_IO06  0x1b0b0 /* SERIAL_CAN_PWR_ENABLE */
		>;
	};

	pinctrl_audmux: audmuxgrp {
		fsl,pins = <
			MX6QDL_PAD_DISP0_DAT23__AUD4_RXD	  0x130b0
			MX6QDL_PAD_DISP0_DAT20__AUD4_TXC	  0x130b0
			MX6QDL_PAD_DISP0_DAT21__AUD4_TXD	  0x110b0
			MX6QDL_PAD_DISP0_DAT22__AUD4_TXFS	 0x130b0
			MX6QDL_PAD_GPIO_0__CCM_CLKO1    0x130b0 /* Audio MCLK */
		>;
	};

	pinctrl_enet: enetgrp {
		fsl,pins = <
			MX6QDL_PAD_ENET_MDIO__ENET_MDIO		0x1b0a8
			MX6QDL_PAD_ENET_MDC__ENET_MDC		0x1b0a8
			MX6QDL_PAD_ENET_RXD0__ENET_RX_DATA0	0x1b0a8
			MX6QDL_PAD_ENET_RXD1__ENET_RX_DATA1	0x1b0a8
			MX6QDL_PAD_ENET_RX_ER__ENET_RX_ER	0x1b0a8
			MX6QDL_PAD_ENET_CRS_DV__ENET_RX_EN      0x1b0a8
			MX6QDL_PAD_ENET_TXD0__ENET_TX_DATA0	0x1b0a8
			MX6QDL_PAD_ENET_TXD1__ENET_TX_DATA1	0x1b0a8
			MX6QDL_PAD_ENET_TX_EN__ENET_TX_EN       0x1b0a8
			MX6QDL_PAD_RGMII_TX_CTL__ENET_REF_CLK   0x4001b0a1
#define GPIO_ENETPHY_RESET	<&gpio1 23 GPIO_ACTIVE_HIGH>
			MX6QDL_PAD_ENET_REF_CLK__GPIO1_IO23	0x1b0b0
#define GPIO_ENET_INT	<&gpio1 3 IRQ_TYPE_LEVEL_HIGH>
			MX6QDL_PAD_GPIO_3__GPIO1_IO03	 0x1b0b0
#define GPIO_REMOTE_RST <&gpio4 15 IRQ_TYPE_LEVEL_HIGH>
			MX6QDL_PAD_KEY_ROW4__GPIO4_IO15	 0x1b0b0
		>;
	};

	pinctrl_flexcan1: flexcan1grp {
		fsl,pins = <
			MX6QDL_PAD_GPIO_7__FLEXCAN1_TX	0x1b0b0
			MX6QDL_PAD_GPIO_8__FLEXCAN1_RX	0x1b0b0
		>;
	};

	pinctrl_hdmi_cec: hdmi-cecgrp {
		fsl,pins = <
			MX6QDL_PAD_EIM_A25__HDMI_TX_CEC_LINE    0x1f8b0
		>;
	};

	pinctrl_i2c1: i2c1grp {
		fsl,pins = <
			MX6QDL_PAD_CSI0_DAT9__I2C1_SCL	    0x4001b8b1
			MX6QDL_PAD_CSI0_DAT8__I2C1_SDA	    0x4001b8b1
		>;
	};

	pinctrl_i2c2: i2c2grp {
		fsl,pins = <
			MX6QDL_PAD_KEY_COL3__I2C2_SCL	   0x4001b8b1
			MX6QDL_PAD_KEY_ROW3__I2C2_SDA	   0x4001b8b1
		>;
	};

	pinctrl_i2c3: i2c3grp {
		fsl,pins = <
			MX6QDL_PAD_EIM_D17__I2C3_SCL	     0x4001b8b1
			MX6QDL_PAD_EIM_D18__I2C3_SDA	    0x4001b8b1
		>;
	};

	pinctrl_pwm1: pwm1grp {
		fsl,pins = <
			MX6QDL_PAD_DISP0_DAT8__PWM1_OUT	 0x1b0b0
		>;
	};

	pinctrl_reg_usbh1_vbus: reg-usbh1-vbusgrp {
		fsl,pins = <
			MX6QDL_PAD_GPIO_4__GPIO1_IO04	   0x1b0b0
		>;
	};

	pinctrl_uart1: uart1grp { /* DBG Console */
		fsl,pins = <
			MX6QDL_PAD_CSI0_DAT10__UART1_TX_DATA    0x1b0b1
			MX6QDL_PAD_CSI0_DAT11__UART1_RX_DATA    0x1b0b1
		>;
	};

	pinctrl_uart2: uart2grp {
		fsl,pins = <
			MX6QDL_PAD_EIM_D25__GPIO3_IO25	  0x1b0b1
#define GPIO_RS485_TX_EN <&gpio3 25 GPIO_ACTIVE_HIGH>
			MX6QDL_PAD_EIM_D26__UART2_TX_DATA       0x1b0b1
			MX6QDL_PAD_EIM_D27__UART2_RX_DATA       0x1b0b1
			MX6QDL_PAD_EIM_D28__GPIO3_IO28	  0x1b0b1
#define GPIO_RS485_RX_EN <&gpio3 28 GPIO_ACTIVE_HIGH>
		>;
	};

	pinctrl_uart3: uart3grp { /* Ultrasonic Sensor 1 */
		fsl,pins = <
			MX6QDL_PAD_SD4_CLK__UART3_RX_DATA    0x1b0b1
			MX6QDL_PAD_SD4_CMD__UART3_TX_DATA    0x1b0b1
		>;
	};

	pinctrl_uart4: uart4grp { /* RFID Serial port */
		fsl,pins = <
			MX6QDL_PAD_KEY_COL0__UART4_TX_DATA 0x1b0b1 /* UART4_TX */
			MX6QDL_PAD_KEY_ROW0__UART4_RX_DATA 0x1b0b1 /* UART4_RX */
		>;
	};

	pinctrl_uart5: uart5grp { /* Ultrasonic Sensor 2 */
		fsl,pins = <
			MX6QDL_PAD_KEY_COL1__UART5_TX_DATA    0x1b0b1
			MX6QDL_PAD_KEY_ROW1__UART5_RX_DATA    0x1b0b1
		>;
	};

	pinctrl_usbh1: usbh1grp {
		fsl,pins = <
#define GPIO_USBH1_HUB_RESET      <&gpio1 5 GPIO_ACTIVE_LOW>
			MX6QDL_PAD_GPIO_5__GPIO1_IO05	   0x030b0
		>;
	};
	pinctrl_usbotg: usbotggrp {
		fsl,pins = <
			MX6QDL_PAD_GPIO_1__USB_OTG_ID		0x17059
		>;
	};

	pinctrl_usdhc1: usdhc1grp { /* SDHC1 --> WLAN */
		fsl,pins = <
			MX6QDL_PAD_SD1_CLK__SD1_CLK	     0x10059
			MX6QDL_PAD_SD1_CMD__SD1_CMD	     0x17059
			MX6QDL_PAD_SD1_DAT0__SD1_DATA0	  0x17059
			MX6QDL_PAD_SD1_DAT1__SD1_DATA1	  0x17059
			MX6QDL_PAD_SD1_DAT2__SD1_DATA2	  0x17059
			MX6QDL_PAD_SD1_DAT3__SD1_DATA3	  0x17059
		>;
	};

	pinctrl_usdhc3: usdhc3grp {
		fsl,pins = <
			MX6QDL_PAD_SD3_CMD__SD3_CMD	     0x17059
			MX6QDL_PAD_SD3_CLK__SD3_CLK	     0x10059
			MX6QDL_PAD_SD3_DAT0__SD3_DATA0	  0x17059
			MX6QDL_PAD_SD3_DAT1__SD3_DATA1	  0x17059
			MX6QDL_PAD_SD3_DAT2__SD3_DATA2	  0x17059
			MX6QDL_PAD_SD3_DAT3__SD3_DATA3	  0x17059
			MX6QDL_PAD_SD3_DAT4__SD3_DATA4	  0x17059
			MX6QDL_PAD_SD3_DAT5__SD3_DATA5	  0x17059
			MX6QDL_PAD_SD3_DAT6__SD3_DATA6	  0x17059
			MX6QDL_PAD_SD3_DAT7__SD3_DATA7	  0x17059
			MX6QDL_PAD_SD3_RST__SD3_RESET	   0x17059
		>;
	};

	pinctrl_i2c3_ap1302_mipi: i2c3_ap1302-mipigrp {
		fsl,pins = <
#define GP_AP1302_MIPI_POWER_DOWN	<&gpio5 25 GPIO_ACTIVE_HIGH>
			MX6QDL_PAD_CSI0_DAT7__GPIO5_IO25		0x1b0b0
#define GP_AP1302_MIPI_RESET	<&gpio5 24 GPIO_ACTIVE_LOW>
			MX6QDL_PAD_CSI0_DAT6__GPIO5_IO24		0x1b0b0
		>;
	};

		/* IPU1 is unit 0. IPU2 is unit 1. */
	pinctrl_i2c3_ap1302_parallel: i2c3-ap1302-parallelgrp {
		fsl,pins = <
			MX6QDL_PAD_CSI0_DAT12__IPU1_CSI0_DATA12		0x1b0b0
			MX6QDL_PAD_CSI0_DAT13__IPU1_CSI0_DATA13		0x1b0b0
			MX6QDL_PAD_CSI0_DAT14__IPU1_CSI0_DATA14		0x1b0b0
			MX6QDL_PAD_CSI0_DAT15__IPU1_CSI0_DATA15		0x1b0b0
			MX6QDL_PAD_CSI0_DAT16__IPU1_CSI0_DATA16		0x1b0b0
			MX6QDL_PAD_CSI0_DAT17__IPU1_CSI0_DATA17		0x1b0b0
			MX6QDL_PAD_CSI0_DAT18__IPU1_CSI0_DATA18		0x1b0b0
			MX6QDL_PAD_CSI0_DAT19__IPU1_CSI0_DATA19		0x1b0b0
			MX6QDL_PAD_CSI0_PIXCLK__IPU1_CSI0_PIXCLK	0x1b0b0
			MX6QDL_PAD_CSI0_MCLK__IPU1_CSI0_HSYNC		0x1b0b0
			MX6QDL_PAD_CSI0_VSYNC__IPU1_CSI0_VSYNC		0x1b0b0
		>;
	};

	pinctrl_i2c3_max96706_gpios: i2c3-max96706-gpiogrp {
		fsl,pins = <
#define GP_MAX96706_POWER_DOWN	<&gpio5 20 GPIO_ACTIVE_LOW>
			MX6QDL_PAD_CSI0_DATA_EN__GPIO5_IO20		0x1b0b0
		>;
	};

	pinctrl_i2c3_ap1302_parallel_gpios: i2c3-ap1302-parallel-gpiogrp {
		fsl,pins = <
#define GP_AP1302_PARALLEL_RESET	<&gpio7 12 GPIO_ACTIVE_HIGH>
			MX6QDL_PAD_GPIO_17__GPIO7_IO12		0x1b0b0
		>;
	};

};

/* disable dvfs as it appears to be causing linux hang after boot */
&busfreq {
	status = "disabled";
};

&audmux {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_audmux>;
	status = "okay";
};


&clks {
	fsl,ldb-di0-parent = <&clks IMX6QDL_CLK_PLL2_PFD0_352M>;
	fsl,ldb-di1-parent = <&clks IMX6QDL_CLK_PLL2_PFD0_352M>;

};

&can1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_flexcan1>;
	status = "okay";
};

&fec {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_enet>;
	phy-mode = "rmii";
	phy-reset-gpios = GPIO_ENETPHY_RESET;
	phy-reset-duration = <2>;
	assigned-clocks = <&clks IMX6QDL_CLK_ENET_REF>;
	assigned-clock-rates = <50000000>;
	status = "okay";
};

&gpc {
	/* use ldo-enable, u-boot will check it and configure */
	fsl,ldo-bypass = <1>;
};

&dcic1 {
	dcic_id = <0>;
	dcic_mux = "dcic-hdmi";
	status = "okay";
};

&dcic2 {
	dcic_id = <1>;
	dcic_mux = "dcic-lvds1";
	status = "okay";
};

/*
&hdmi_audio {
	status = "okay";
};*/

&hdmi_cec {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_hdmi_cec>;
	status = "okay";
};

&hdmi_core {
	ipu_id = <0>;
	disp_id = <0>;
	status = "okay";
};

&hdmi_video {
	fsl,phy_reg_vlev = <0x0294>;
	fsl,phy_reg_cksymtx = <0x800d>;
	status = "okay";
};

&i2c1 {
	clock-frequency = <100000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c1>;
	status = "okay";

	rtc: ds1307@68 { /* CPNK RTC */
		compatible = "dallas,ds1307";
		pinctrl-names = "default";
		reg = <0x68>;
	};

	cpnk_uxtemp_sensor: tc74@48 {
		compatible = "tc74";
		reg = <0x48>;
	};

	cpnk_temp_sensor: tc74@4d {
		compatible = "tc74";
		reg = <0x4d>;
	};
};

&i2c2 {
	clock-frequency = <100000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c2>;
	status = "okay";

	hdmi_edid: edid@50 {
		compatible = "fsl,imx6-hdmi-i2c";
		reg = <0x50>;
	};
};

&i2c3 {
	clock-frequency = <100000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c3>;
	status = "okay";

	pmic: pfuze100@08 {
		compatible = "fsl,pfuze100";
		reg = <0x08>;

		regulators {
			sw1a_reg: sw1ab {
				regulator-min-microvolt = <300000>;
				regulator-max-microvolt = <1875000>;
				regulator-boot-on;
				regulator-always-on;
				regulator-ramp-delay = <6250>;
			};

			sw1c_reg: sw1c {
				regulator-min-microvolt = <300000>;
				regulator-max-microvolt = <1875000>;
				regulator-boot-on;
				regulator-always-on;
				regulator-ramp-delay = <6250>;
			};

			sw2_reg: sw2 {
				regulator-min-microvolt = <800000>;
				regulator-max-microvolt = <3300000>;
				regulator-boot-on;
				regulator-always-on;
				regulator-ramp-delay = <6250>;
			};

			sw3a_reg: sw3a {
				regulator-min-microvolt = <400000>;
				regulator-max-microvolt = <1975000>;
				regulator-boot-on;
				regulator-always-on;
			};

			sw3b_reg: sw3b {
				regulator-min-microvolt = <400000>;
				regulator-max-microvolt = <1975000>;
				regulator-boot-on;
				regulator-always-on;
			};

			sw4_reg: sw4 {
				regulator-min-microvolt = <800000>;
				regulator-max-microvolt = <3300000>;
			};

			swbst_reg: swbst {
				regulator-min-microvolt = <5000000>;
				regulator-max-microvolt = <5150000>;
			};

			snvs_reg: vsnvs {
				regulator-min-microvolt = <1000000>;
				regulator-max-microvolt = <3000000>;
			};

			vref_reg: vrefddr {
				regulator-boot-on;
				regulator-always-on;
			};

			vgen1_reg: vgen1 {
				regulator-min-microvolt = <800000>;
				regulator-max-microvolt = <1550000>;
			};

			vgen2_reg: vgen2 {
				regulator-min-microvolt = <800000>;
				regulator-max-microvolt = <1550000>;
			};

			vgen3_reg: vgen3 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
			};

			vgen4_reg: vgen4 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};

			vgen5_reg: vgen5 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};

			vgen6_reg: vgen6 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};
		};
	};

	ar0330_mipi: ar0330_mipi@3C {
		compatible = "ar0330_mipi";
		reg = <0x3C>;
		clocks = <&clks 201>;
		clock-names = "csi_mclk";
		DOVDD-supply = <&reg_mipi_dovdd>; /* 1.8v */
		AVDD-supply = <&reg_mipi_avdd>;  /* 2.8v, rev C board is VGEN3
						rev B board is VGEN5 */
		DVDD-supply = <&reg_mipi_dvdd>;  /* 1.5v*/
		pwn-gpios = <&gpio6 4 0>;   /* active high: DISP_DATA11 */
		rst-gpios = <&gpio6 3 0>;   /* active low: DISP_DATA10 */
		ipu_id = <0>;
		csi_id = <1>;
		vc = <1>;
		mclk = <24000000>;
		mclk_source = <0>;
		status="okay";
	};

	ap1302_mipi: ap1302_mipi@3D {
		compatible = "ap1302";
		reg = <0x3D>;
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_i2c3_ap1302_mipi>;
		clocks = <&clks IMX6QDL_CLK_CKO>;
		clock-names = "csi_mclk";
		DOVDD-supply = <&reg_mipi_dovdd>;
		AVDD-supply = <&reg_mipi_avdd>;
		DVDD-supply = <&reg_mipi_dvdd>;
		pwn-gpios = GP_AP1302_MIPI_POWER_DOWN;
		rst-gpios = GP_AP1302_MIPI_RESET;
		ipu_id = <1>;
		csi_id = <0>;
		mclk = <24000000>;
		mclk_source = <0>;
		status="okay";
	};

	codec: wm8974@1a {
		compatible = "wlf,wm8974";
		reg = <0x1a>;
		clocks = <&clks IMX6QDL_CLK_CKO>;
		clock-names = "mclk";
		wlf,shared-lrclk;
		DCVDD-supply = <&reg_audio>;
		DBVDD-supply = <&reg_audio>;
		AVDD-supply = <&reg_audio>;
		CPVDD-supply = <&reg_audio>;
		PLLVDD-supply = <&reg_audio>;
		SPKVDD1-supply = <&reg_spk_audio>;
		SPKVDD2-supply = <&reg_spk_audio>;
		amic-mono;
	};

	/* The deserializer is also an i2c adapter */
	lvds_des: deserializer@58 {
		#address-cells = <1>;
		#size-cells = <0>;
		compatible = "max,max96706";
		reg = <0x58>;
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_i2c3_max96706_gpios>;
		AVDD-supply = <&reg_p3v3>;  /* locally converted to 1.8v */
		DVDD-supply = <&reg_p3v3>;  /* locally converted to 1.8v */
		pwn-gpios = GP_MAX96706_POWER_DOWN;
	};

};

/* Below describes devices that are remote devices of the deserializer */
&lvds_des {

	ranges;

	lvds_ser: serializer@40 {
		compatible = "max,max96707";
		reg = <0x40>;
	};

	ap1302_parallel: ap1302_parallel@3C {
		compatible = "ap1302_parallel";
		reg = <0x3C>;
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_i2c3_ap1302_parallel>;
		clocks = <&clks IMX6QDL_CLK_CKO>;
		clock-names = "csi_mclk";
		/*DOVDD-supply = <&reg_1p8v>;*/
		/*AVDD-supply = <&reg_2p5v>;*/
		/*DVDD-supply = <&reg_1p8v>;*/
		/* This really is the mipi parallel converter reset pin */
		/* ap1302 power and reset pin are controlled by converter's local gpio */
		rst-gpios = GP_AP1302_PARALLEL_RESET;
		ipu_id = <0>;
		csi_id = <0>;
		mclk = <24000000>;
		mclk_source = <0>;
	};
};

&mipi_csi {
	 status = "okay";
	 ipu_id = <1>;
	 csi_id = <0>;
	 v_channel = <2>;
	 lanes = <3>;
};


&ldb {
	status = "okay";

	lvds-channel@0 {
		crtc = "ipu2-di0";
		fsl,data-mapping = "spwg";
		fsl,data-width = <24>;
		status = "okay";
		primary;

		/* Values need to be rework once display available */
		display-timings {
			native-mode = <&ampire>;
			ampire: AM-1024768Y2TZQW-A2H {
				clock-frequency = <65000000>;
				hactive = <1024>;
				vactive = <768>;
				hback-porch = <220>;
				hfront-porch = <40>;
				vback-porch = <21>;
				vfront-porch = <7>;
				hsync-len = <60>;
				vsync-len = <10>;
			};
			Kyocera: TCG104XGLPAPNN-AN40 {
				clock-frequency = <65000000>;
				hactive = <1024>;
				vactive = <768>;
				hback-porch = <220>;
				hfront-porch = <40>;
				vback-porch = <21>;
				vfront-porch = <7>;
				hsync-len = <60>;
				vsync-len = <10>;
			};
		};
	};
};

&pwm1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_pwm1>;
	status = "okay";
};

&reg_arm {
	vin-supply = <&sw2_reg>;
	regulator-allow-bypass;
};

&reg_soc {
	vin-supply = <&sw1c_reg>;
	regulator-allow-bypass;
};

&reg_pu {
	vin-supply = <&sw1c_reg>;
	regulator-allow-bypass;
};

/* XXX - unclear if this is doable or not */
&snvs_poweroff {
	status = "disabled";
};

&ssi1 {
	fsl,mode = "i2s-master";
	status = "okay";
};

&uart1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart1>;
	status = "okay";
};

&uart2 { /* RS485 meter */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart2>;
	control-gpios = GPIO_RS485_TX_EN, GPIO_RS485_RX_EN;
#define M_RX_EN		1
#define M_TX_EN		2
	off_levels = <0>;
	rxact_mask = <0>;
	rxact_levels = <0>;
	rs232_levels = <M_RX_EN>;
	rs232_txen_mask = <0>;
	rs232_txen_levels = <0>;
	rs485_levels = <0xd>;
	rs485_txen_mask = <0x3>;
	rs485_txen_levels = <M_TX_EN>;
	uart-has-rs485-half-duplex;
	rs485-mode = <1>;	/* 1 to enable */
	fsl,uart-has-rtscts;
	status = "okay";
};

&uart3 { /* Ultrasonic Sensor #1 */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart3>;
	status = "okay";
};

&uart4 { /* RFID Reader */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart4>;
	status = "okay";
};

&uart5 { /* Ultrasonic Sensor #2 */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart5>;
	status = "okay";
};

&usbh1 {
	vbus-supply = <&reg_usbh1_vbus>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usbh1>;
	disable-over-current;
	reset-gpios = GPIO_USBH1_HUB_RESET;
	status = "okay";
};

&usbotg {
	vbus-supply = <&reg_usbotg_vbus>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usbotg>;
	disable-over-current;
	dr_mode = "otg";
	status = "okay";
};

&usdhc1 {       /* uSDHC1, Redpine WiFi */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usdhc1>;
	bus-width = <8>;
	no-1-8-v;
	non-removable;
	keep-power-in-suspend;
	enable-sdio-wakeup;
	max-frequency	= <33000000>;
	status = "okay";
};

&usdhc3 {       /* eMMC */
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usdhc3>;
	bus-width = <8>;
	non-removable;
	no-1-8-v;
	keep-power-in-suspend;
	status = "okay";
};
